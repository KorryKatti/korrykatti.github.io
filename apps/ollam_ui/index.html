<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ollama Web UI</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@400;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.10.38/pdf.min.mjs" type="module"></script>
</head>

<body class="dark-theme">
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">â—‹</span>
                    <span class="logo-text">Ollama</span>
                </div>
                <button id="new-chat-btn" class="icon-btn" title="New Chat">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
                    </svg>
                </button>
            </div>

            <div class="sidebar-content">
                <button id="new-chat-btn">New Chat</button>
            </div>
            <div class="sidebar-nav">
                <div class="nav-section">
                    <h3>History</h3>
                    <div id="chat-history">
                        <!-- History items without icons -->
                    </div>
                </div>
            </div>
            <div class="resource-monitor">
                <div class="stat-item">CPU: <span id="cpu-usage">--%</span></div>
                <div class="stat-item">RAM: <span id="ram-usage">-- / -- GB</span></div>
            </div>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <span id="username-display">User</span>
                </div>
                <button id="settings-btn">Settings</button>
            </div>
        </aside>

        <main>
            <header>
                <div class="model-selector">
                    <select id="model-select">
                        <option disabled selected>Connecting...</option>
                    </select>
                </div>
                <div id="status-indicator" class="status-indicator">
                    <div class="status-dot"></div>
                    <span class="status-text">Status: Offline</span>
                </div>
            </header>

            <div id="chat-container" class="chat-container">
                <div id="welcome-screen" class="welcome-screen">
                    <h1>How can I help you today?</h1>
                    <div class="suggestions-grid">
                        <div class="suggestion-card">
                            <p>"Assistance with document processing."</p>
                        </div>
                        <div class="suggestion-card">
                            <p>"Standard technical query resolution."</p>
                        </div>
                        <div class="suggestion-card">
                            <p>"Drafting of routine correspondence."</p>
                        </div>
                        <div class="suggestion-card">
                            <p>"Verification of system data logic."</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-area">
                <div class="context-info" id="context-info">
                    <div class="context-bar-bg">
                        <div id="context-bar"></div>
                    </div>
                </div>
                <div id="attachments-container" class="attachments-container"></div>
                <div class="input-container">
                    <textarea id="user-input" placeholder="Type message..."></textarea>
                    <div class="input-actions">
                        <input type="file" id="file-input" multiple hidden>
                        <button id="attach-btn">Attach</button>
                        <button id="stop-btn">Stop</button>
                        <button id="send-btn" disabled>Send</button>
                    </div>
                </div>
                <p class="disclaimer">Ollama can make mistakes. Check important info.</p>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 16px; font-weight: normal;">Settings</h2>
                <button id="close-settings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-item">
                    <label>User Name</label>
                    <input type="text" id="setting-username" placeholder="Enter your name">
                </div>
                <div class="setting-item">
                    <label>Profile Picture</label>
                    <input type="file" id="setting-avatar" accept="image/*">
                </div>
                <div class="setting-item">
                    <label>System Prompt (Personality)</label>
                    <textarea id="setting-system-prompt" rows="3"
                        placeholder="e.g. You are a helpful assistant who speaks like a pirate."></textarea>
                </div>
                <div class="setting-item checkbox-setting">
                    <label>
                        <input type="checkbox" id="setting-include-time">
                        Include current time in messages
                    </label>
                </div>
                <div class="setting-item">
                    <label>Default Context Limit (tokens)</label>
                    <div class="input-with-hint">
                        <input type="number" id="setting-context-limit" value="4096" step="512">
                        <small>Auto-updates based on model if available</small>
                    </div>
                </div>
                <div class="setting-item">
                    <label>Ollama Base URL</label>
                    <input type="text" id="setting-ollama-url" value="http://localhost:11434">
                </div>
                <div class="setting-item">
                    <label>Theme</label>
                    <select id="setting-theme">
                        <option value="dark">Dark</option>
                        <option value="light">Light</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label>CONNECTION_DIAGNOSTICS (CORS/SSL)</label>
                    <div
                        style="font-size: 11px; color: var(--text-secondary); border: 1px solid var(--border-color); padding: 10px; background: rgba(0,0,0,0.02); margin-top: 5px;">
                        If your status is BLOCKED or OFFLINE when hosted:<br><br>
                        1. <strong>OLLAMA_ORIGINS</strong>: You must tell Ollama to allow this site. Run:<br>
                        <code
                            style="display:block; margin:5px 0; background:#eee; padding:3px; color:#000;">launchctl setenv OLLAMA_ORIGINS "https://korrykatti.github.io"</code>
                        (macOS) or set as System Env Var (Win/Linux).<br>
                        2. <strong>Restart Ollama</strong> for settings to take effect.<br>
                        3. <strong>Mixed Content</strong>: If browser blocks https -> http, you may need to allow
                        "Insecure Content" for this specific domain in Site Settings.
                    </div>
                </div>
                <hr>
                <div class="setting-item danger-zone">
                    <label>Data Management</label>
                    <button id="clear-history-btn" class="danger-btn">Clear All Chat History</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>