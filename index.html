<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>korry</title>
    <meta name="description" content="god's favourite test subjet">
    <meta name="keywords" content="portfolio, blog, projects, web developer, korry, korrykatti">
    <meta name="author" content="korry">
    <link rel="icon" href="img/icon.jpeg">
    <link rel="stylesheet" href="style.css">
</head>
<body class="light">
    <canvas id="shader-bg"></canvas>
    <button class="theme-toggle" onclick="toggleTheme()">☾</button>
    <div class="main-container">
        <img src="img/main-image.png" alt="icon" class="main-image">
        <div class="main-text">
            <p>hello , korry here<br>this website is well , forever wip cuz i keep changing it , but this is a collection of my work i like to show and some other stuff which i think are cool. i am still in college and learning and yeah thats it</p>
            <div class="links-container">
                <div class="link-section">
                    <h3>PROJECTS & BLOG</h3>
                    <a href="https://korrykatti.is-a.dev/project_sites/mirage/index.html" class="link">mirage</a>
                    <a href="apps/index.html" class="link">smol web apps</a>
                    <a href="https://korrykatti.pythonanywhere.com/" class="link">image board</a>
                    <a href="/blog/index.html" class="link special-link">blog</a>
                </div>
                <div class="link-section">
                    <h3>LINKS</h3>
                    <a href="/guestbook.html" class="link">guestbook</a>
                    <a href="https://github.com/korrykatti" class="link">github</a>
                    <a href="https://x.com/dunkelkron" class="link">x.com</a>
                    <a href="mailto:korrykatti@proton.me" class="link">email</a>
                    <a href="https://open.spotify.com/user/c9khdo6s2n2q8o54qe7punql7" class="link">spotify</a>
                </div>
                <div class="link-section">
                    <h3>SPECIAL</h3>
                    <a href="https://korrykatti.is-a.dev/project_sites/thunder/index.html" class="link">thunder</a>
                    <a href="logs.html" class_="link special-link">logs</a>
                </div>
            </div>
            <div class="expandable">
                <button class="toggle-btn" id="toggle-collapse">SHOW_MORE</button>
                <div class="collapse-content" id="collapse-section">
                    <div id="last-updated">SYSTEM_STATUS: loading...</div>
                    <br>
                    <button class="toggle-btn" id="open-modal-btn">OPEN_CHAT</button>
                </div>
            </div>
        </div>
    </div>
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-title">COMMUNICATION_LINK</div>
            <iframe src="https://www5.cbox.ws/box/?boxid=952319&boxtag=ZWCF6N" width="400" height="400"></iframe>
            <button class="close-btn" id="close-modal-btn">DISCONNECT</button>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('shader-bg');
        if (canvas) {
            const gl = canvas.getContext('webgl');
            let time = 0;

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                gl.viewport(0, 0, canvas.width, canvas.height);
            }

            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();

            const vertexShaderSource = `
                attribute vec2 position;
                void main() {
                    gl_Position = vec4(position, 0.0, 1.0);
                }
            `;

            const fragmentShaderSource = `
                precision mediump float;
                uniform vec2 resolution;
                uniform float time;

                vec3 palette(float t) {
                    float gray = 0.5 + 0.5 * cos(6.28318 * t);
                    return vec3(gray);
                }

                void main() {
                    vec2 uv = (gl_FragCoord.xy * 2.0 - resolution) / resolution.y;
                    vec2 uv0 = uv;
                    vec3 finalColor = vec3(0.0);

                    for (float i = 0.0; i < 3.0; i++) {
                        uv = fract(uv * 2.5) - 0.5;
                        float d = length(uv) * exp(-length(uv0));
                        vec3 col = palette(length(uv0) + i * 0.4 + time * 0.4);
                        d = sin(d * 12.0 + time) / 12.0;
                        d = abs(d);
                        d = pow(0.008 / d, 1.2);
                        finalColor += col * d;
                    }

                    gl_FragColor = vec4(finalColor * 0.08, 1.0);
                }
            `;

            function createShader(type, source) {
                const shader = gl.createShader(type);
                gl.shaderSource(shader, source);
                gl.compileShader(shader);
                return shader;
            }

            const vertexShader = createShader(gl.VERTEX_SHADER, vertexShaderSource);
            const fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentShaderSource);

            const program = gl.createProgram();
            gl.attachShader(program, vertexShader);
            gl.attachShader(program, fragmentShader);
            gl.linkProgram(program);
            gl.useProgram(program);

            const positionBuffer = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
                -1, -1,
                1, -1,
                -1, 1,
                1, 1
            ]), gl.STATIC_DRAW);

            const positionLocation = gl.getAttribLocation(program, 'position');
            gl.enableVertexAttribArray(positionLocation);
            gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

            const resolutionLocation = gl.getUniformLocation(program, 'resolution');
            const timeLocation = gl.getUniformLocation(program, 'time');

            function animate() {
                time += 0.01;
                gl.uniform2f(resolutionLocation, canvas.width, canvas.height);
                gl.uniform1f(timeLocation, time);
                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
                requestAnimationFrame(animate);
            }

            animate();
        }

        function toggleTheme() {
            const body = document.body;
            const btn = document.querySelector('.theme-toggle');
            
            if (body.classList.contains('light')) {
                body.classList.remove('light');
                body.classList.add('dark');
                btn.textContent = '☀';
            } else {
                body.classList.remove('dark');
                body.classList.add('light');
                btn.textContent = '☾';
            }
        }

        // Toggle collapse functionality
        document.addEventListener('DOMContentLoaded', () => {
            const toggleBtn = document.getElementById('toggle-collapse');
            const collapseSection = document.getElementById('collapse-section');

            toggleBtn.addEventListener('click', () => {
                const isVisible = collapseSection.classList.contains('show');
                if (isVisible) {
                    collapseSection.classList.remove('show');
                    toggleBtn.textContent = 'SHOW_MORE';
                } else {
                    collapseSection.classList.add('show');
                    toggleBtn.textContent = 'HIDE_MORE';
                }
            });

            // Modal functionality
            const openModalBtn = document.getElementById('open-modal-btn');
            const modal = document.getElementById('modal');
            const closeModalBtn = document.getElementById('close-modal-btn');

            if (openModalBtn) {
                openModalBtn.addEventListener('click', () => {
                    modal.style.display = 'flex';
                });
            }

            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', () => {
                    modal.style.display = 'none';
                });
            }

            // Close modal on outside click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // Get last commit info
        async function getLastCommit() {
            try {
                const response = await fetch("https://api.github.com/repos/korrykatti/korrykatti.github.io/commits");
                const commits = await response.json();
                const lastCommitDate = new Date(commits[0].commit.committer.date);

                const now = new Date();
                const diffTime = Math.abs(now - lastCommitDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                document.getElementById('last-updated').textContent = 
                    `LAST_UPDATE: ${diffDays} days ago (${lastCommitDate.toDateString()})`;
            } catch (error) {
                console.error("Error fetching last commit:", error);
                document.getElementById('last-updated').textContent = "SYSTEM_ERROR: update data unavailable";
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            getLastCommit();
        });
    </script>
</body>
</html>
